function getData(e=$("#save").val(),a=$("#progressId").val()){return"classic"===$("#start-analyse").attr("data-target")?{_token:$('meta[name="csrf-token"]').attr("content"),save:$("#save_classic").val(),region:$("#region_classic").val(),phrases:$("#phrases_classic").val(),domain:$("#domain-textarea_classic").val(),sendMessage:$("#sendMessage_classic").val(),comment:$("#comment-textarea_classic").val(),clusteringLevel:$("#clusteringLevel_classic").val(),searchBase:$("#searchBase_classic").is(":checked"),searchTarget:$("#searchTarget_classic").is(":checked"),searchPhrases:$("#searchPhrases_classic").is(":checked"),searchRelevance:$("#searchRelevance_classic").is(":checked"),mode:"classic",progressId:a}:{_token:$('meta[name="csrf-token"]').attr("content"),save:e,progressId:a,region:$("#region").val(),count:$("#count").val(),phrases:$("#phrases").val(),clusteringLevel:$("#clusteringLevel").val(),searchBase:$("#searchBase").is(":checked"),searchPhrases:$("#searchPhrases").is(":checked"),searchTarget:$("#searchTarget").is(":checked"),domain:$("#domain-textarea").val(),comment:$("#comment-textarea").val(),sendMessage:$("#sendMessage").val(),brutForce:$("#brutForce").is(":checked"),searchRelevance:$("#searchRelevance").is(":checked"),searchEngine:$("#searchEngine").val(),mode:$("#start-analyse").attr("data-target"),brutForceCount:$("#brutForceCount").val(),reductionRatio:$("#reductionRatio").val(),ignoredWords:$("#ignoredWords").val(),ignoredDomains:$("#ignoredDomains").val(),gainFactor:$("#gainFactor").val()}}function setProgressBarStyles(e){$("#progress-bar-state").html("Просканировано: "+e+" из ")}function downloadSites(e,a,c){"download"===c&&" "!==$("span[data-action='"+a+"']").html()||$.ajax({type:"POST",url:"/download-cluster-sites",dataType:"json",data:{_token:$('meta[name="csrf-token"]').attr("content"),phrase:a,projectId:e},success:function(e){if("download"===c){let c=$("span[data-action='"+a+"']"),s="";"mark"in e&&0!==e.mark?$.each(e.mark,function(e,a){s+=a?'<div class="text-muted">   <a href="'+e+'" target="_blank">'+new URL(e).host+"</a> (игнорируемый)</div>":'<div>   <a href="'+e+'" target="_blank">'+new URL(e).host+"</a></div>"}):$.each(e.sites,function(e,a){s+='<div>   <a href="'+a+'" target="_blank">'+new URL(a).host+"</a></div>"}),c.html(""),c.append(s)}else{if("mark"in e&&0!==e.mark){let a=[];$.each(e.mark,function(e,c){c||a.push(e)}),$("#hiddenForCopy").val(a.join("\r"))}else $("#hiddenForCopy").val(e.sites.join("\r"));copyInBuffer()}},error:function(e){}})}function downloadAllCompetitors(e,a){" "===$("#competitors-"+a.replaceAll(" ","-")).html()&&$.ajax({type:"POST",url:"/download-cluster-competitors",dataType:"json",data:{_token:$('meta[name="csrf-token"]').attr("content"),key:a,projectId:e},success:function(e){let c="";$.each(e.competitors,function(e,a){c+='<div>   <a href="'+e+'" target="_blank">'+new URL(e).host+"</a> :"+a+"</div>"}),$("#competitors-"+a.replaceAll(" ","-")).html(c)},error:function(e){}})}function isSearchRelevance(){$("#searchRelevance").is(":checked")?$("#searchEngineBlock").show(300):$("#searchEngineBlock").hide(300)}function isSearchRelevanceClassic(){$("#searchRelevance_classic").is(":checked")?$("#searchEngineBlock_classic").show(300):$("#searchEngineBlock_classic").hide(300)}function saveAllUrls(e){let a,c;$(".save-all-urls").unbind().on("click",function(){a=$(this),c=a.parents().eq(3).children("td").eq(0).children("table").eq(0).children("tbody").children("tr"),$("#relevanceUrls").html("");let e=[];$.each(c,function(){let a=$(this).children("td").eq(4);0===a.children("a").length&&$.each(a.children("div").eq(0).children("select").eq(0).children("option"),function(){e.push($(this).val())})});let s=new Set([...e]);for(let e of s)$("#relevanceUrls").append($("<option>",{value:e,text:e}))}),$("#save-cluster-url-button").unbind().on("click",function(){let a=[];$.each(c,function(e,c){let s=$(this);if(0===s.children("td").eq(4).children("a").length){if(void 0!==s.children("td").eq(2).attr("title")){let e=s.children("td").eq(2).attr("title");e=(e=(e=(e=e.replace('Ваша фраза "',"")).replace('Your phrase "',"")).replace('" была изменена',"")).replace('" has been changed',""),a.push(e)}else a.push(s.children("td").eq(2).children("div").eq(0).children("div").eq(0).html());s.children("td").eq(4).html('<a href="'+$("#relevanceUrls").val()+'" target="_blank">'+$("#relevanceUrls").val()+"</a>")}}),$.ajax({type:"POST",url:"/set-cluster-relevance-urls",data:{_token:$('meta[name="csrf-token"]').attr("content"),phrases:a,url:$("#relevanceUrls").val(),projectId:e},success:function(){},error:function(e){}})})}$("#save").on("change",function(){"1"===$("#save").val()?$("#extra-block").show():$("#extra-block").hide()}),$(document).ready(function(){$("#searchRelevance").on("click",function(){isSearchRelevance()}),$("#searchRelevance_classic").on("click",function(){isSearchRelevanceClassic()}),isSearchRelevance(),isSearchRelevanceClassic(),$("#brutForce").is(":checked")?$(".brut-force").show(300):$(".brut-force").hide(300),$("#brutForce_classic").is(":checked")?$(".brut-force_classic").show(300):$(".brut-force_classic").hide(300)});

function renderResultTable(t){let a=0;$.each(t,function(t,e){let o,s=0,l="",d="",r=(Math.random()+1).toString(36).substring(7),i="120px",n=[];$.each(e,function(t,d){if("finallyResult"!==t){a++,s++;let c=0;"phrased"in d&&(c=0===d.phrased?0:d.phrased.number);let p=0;"target"in d&&(p=0===d.target?0:d.target.number);let h,y=0;"based"in d&&(y=0===d.based?0:d.based.number),"groupName"in e.finallyResult?(h=e.finallyResult.groupName,o="250px"):(h=" ",o="50px");let u="";"merge"in d&&$.each(d.merge,function(t,a){u='<span class="__helper-link ui_tooltip_w">      <i class="fa fa-question"></i>      <span class="ui_tooltip __right" style="min-width: 550px;">          <span class="ui_tooltip_content">'+t+"<br> "+a+"</span>      </span>  </span>"});let b,f,v,g="";"link"in d?(i="450px",g='<a href="'+d.link+'" target="_blank">'+d.link+"</a>"):"relevance"in d&&0!==d.relevance&&(i="450px",$.each(d.relevance,function(t,a){g+='<option value="'+a+'">'+a+"</option>",n.push(a)}),g='<div class="d-flex"><select style="border-radius: 0 !important;" class="custom-select" id="'+t.replaceAll(" ","-")+'">'+g+'</select><button style="border-radius: 0 !important;" class="btn btn-secondary save-relevance-url" data-order="'+t+'"><i class="fa fa-save" style="color: white"></i></button></div>'),"basedNormal"in d&&(!1===d.basedNormal||!0!==d.basedNormal)?(f="bg-cluster-warning",b=`title='Ваша фраза "${t}" была изменена'`,v=d.based.phrase):(f="",b="",v=t),l+='<tr>   <td class="border-0">'+a+'</td>    <td class="border-0"> '+s+'</td>    <td class="border-0 '+f+'" '+b+'>        <div class="d-flex justify-content-between">           <div class="cluster-id-'+r+'">'+v+'</div>           <div class="ml-1">             <i class="fa fa-copy copy-full-urls" data-action="'+v+'"></i>             <span class="__helper-link ui_tooltip_w">                 <i class="fa fa-paperclip" data-action="'+v+'"></i>                 <span class="ui_tooltip __bottom" style="min-width: 250px;">                     <span class="ui_tooltip_content" data-action="'+v+'"> </span>                 </span>             </span>'+u+'          </div>        </div>   </td>    <td class="border-0 group-'+r+'">'+h+'</td>   <td class="border-0 relevance-'+r+'">'+g+'</td>   <td class="border-0 base-'+r+'" data-target="'+y+'">'+y+'</td>   <td class="border-0 phrase-'+r+'" data-target="'+c+'">'+c+'</td>   <td class="border-0 target-'+r+'" data-target="'+p+'">'+p+"</td></tr>"}}),d+='<tr class="render">   <td class="p-0">       <table class="table table-hover text-nowrap render-table" id="render-table'+t+'" style="width: 100%">       <thead>           <tr>               <th colspan="4" style="border-bottom: 0; border-top: 0;"></th>               <th class="centered-text border-0" colspan="3">Частотность</th>           </tr>           <tr>               <th style="border-top-width: 2px;min-width: 25px;" title="Порядковый номер">#</th>               <th style="border-top-width: 2px;min-width: 30px;" title="Порядковый номер в кластере">##</th>               <th style="border-top-width: 2px;min-width: 250px;">Ключевой запрос</th>               <th style="border-top-width: 2px;min-width: '+o+'">Группа</th>               <th style="border-top-width: 2px;min-width: '+i+'">                   Релевантные url               </th>               <th style="border-top-width: 2px;min-width: 70px;">Базовая</th>               <th style="border-top-width: 2px;min-width: 100px;">"Фразовая"</th>               <th style="border-top-width: 2px;min-width: 90px;">"!Точная"</th>           </tr>       </thead>       <tbody>'+l+'</tbody>       </table>   </td>   <td>       <div class="row" style="cursor: pointer">            <p class="copy-cluster-phrases col mr-1" data-target="'+r+'" data-toggle="collapse">                <i class="fa fa-copy pr-1"></i>ключевой запрос            </p>            <p class="copy-group col mr-1" data-target="'+r+'" data-toggle="collapse">                <i class="fa fa-copy pr-1"></i>группу            </p>       </div>       <div class="row" style="cursor: pointer">              <p class="copy-based col" data-target="'+r+'" data-toggle="collapse">                   <i class="fa fa-copy pr-1"></i>базовую              </p>              <p class="copy-phrase col" data-target="'+r+'" data-toggle="collapse">                   <i class="fa fa-copy pr-1"></i>фразовую              </p>              <p class="copy-target col" data-target="'+r+'" data-toggle="collapse">                   <i class="fa fa-copy pr-1"></i>точную              </p>       </div>        <div class="row" style="cursor: pointer">            <div class="col-6">                 <a class="btn btn-secondary all-competitors" data-action="'+t+'" data-toggle="collapse"                   href="#competitors'+t+'" role="button" aria-expanded="false"                   aria-controls="competitors'+t+'">                   Конкуренты               </a>            </div>           <div class="col-6">               <button class="btn btn-secondary save-all-urls" data-toggle="modal" data-target="#saveUrlsModal" data-urls="'+[...new Set(n)]+'">                   Сохранить url               </button>           </div>       </div>       <div class="collapse" id="competitors'+t+'"> </div>   </td></tr>',$("#clusters-table-tbody").append(d)}),copyBased(),copyPhrases(),copyTarget(),copyCluster(),copyGroup(),$(document).ready(function(){$.each($(".render-table"),function(t,a){$("#"+$(this).attr("id")).dataTable({order:[[0,"asc"]],bPaginate:!1,orderCellsTop:!0,sDom:'<"top"i>rt<"bottom"lp><"clear">'})})})}function copyCluster(){$(".copy-cluster-phrases").unbind().on("click",function(){$("#hiddenForCopy").css("display","block"),$("#hiddenForCopy").val("");let t=$(this).attr("data-target"),a=$(".cluster-id-"+t);$.each(a,function(t,a){let e=$(this).html().trim();""===$("#hiddenForCopy").val()?$("#hiddenForCopy").val(e):$("#hiddenForCopy").val($("#hiddenForCopy").val()+"\n"+e)}),copyInBuffer(),successCopiedMessage()})}function copyGroup(){$(".copy-group").unbind().on("click",function(){$("#hiddenForCopy").css("display","block"),$("#hiddenForCopy").val("");let t=$(this).attr("data-target"),a=$(".group-"+t);$.each(a,function(t,a){let e=$(this).html().trim();""===$("#hiddenForCopy").val()?$("#hiddenForCopy").val(e):$("#hiddenForCopy").val($("#hiddenForCopy").val()+"\n"+e)}),copyInBuffer()})}function copyBased(){$(".copy-based").unbind().on("click",function(){$("#hiddenForCopy").css("display","block"),$("#hiddenForCopy").val("");let t=$(this).attr("data-target"),a=$(".base-"+t);$.each(a,function(t,a){let e=$(this).html().trim();""===$("#hiddenForCopy").val()?$("#hiddenForCopy").val(e):$("#hiddenForCopy").val($("#hiddenForCopy").val()+"\n"+e)}),copyInBuffer()})}function copyPhrases(){$(".copy-phrase").unbind().on("click",function(){$("#hiddenForCopy").css("display","block"),$("#hiddenForCopy").val("");let t=$(this).attr("data-target"),a=$(".phrase-"+t);$.each(a,function(t,a){let e=$(this).html().trim();""===$("#hiddenForCopy").val()?$("#hiddenForCopy").val(e):$("#hiddenForCopy").val($("#hiddenForCopy").val()+"\n"+e)}),copyInBuffer()})}function copyTarget(){$(".copy-target").unbind().on("click",function(){$("#hiddenForCopy").css("display","block"),$("#hiddenForCopy").val("");let t=$(this).attr("data-target"),a=$(".target-"+t);$.each(a,function(t,a){let e=$(this).html().trim();""===$("#hiddenForCopy").val()?$("#hiddenForCopy").val(e):$("#hiddenForCopy").val($("#hiddenForCopy").val()+"\n"+e)}),copyInBuffer()})}function copyInBuffer(){successCopiedMessage(),$("#hiddenForCopy").css("display","block"),document.getElementById("hiddenForCopy").select(),document.execCommand("copy"),$("#hiddenForCopy").css("display","none")}
